# Advanced AI Mystery Wizard - System Architecture

## ğŸ—ï¸ Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER INTERFACE                            â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         Advanced AI Mystery Wizard Modal                  â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Step 1: Industry Context                                 â”‚  â”‚
â”‚  â”‚  â”œâ”€ Industry Selection (8 options)                        â”‚  â”‚
â”‚  â”‚  â”œâ”€ Topic Summary (4 lines, 400 chars)                    â”‚  â”‚
â”‚  â”‚  â”œâ”€ Location (City/Country)                               â”‚  â”‚
â”‚  â”‚  â””â”€ Date Picker                                           â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Step 2: Game Mechanics                                   â”‚  â”‚
â”‚  â”‚  â”œâ”€ Difficulty (Beginner/Medium/Advanced)                 â”‚  â”‚
â”‚  â”‚  â”œâ”€ Suspect Count (2-10)                                  â”‚  â”‚
â”‚  â”‚  â””â”€ Diversity Toggle                                      â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Step 3: Learning Objectives                              â”‚  â”‚
â”‚  â”‚  â”œâ”€ Dynamic Objective List                                â”‚  â”‚
â”‚  â”‚  â”œâ”€ Add/Remove Objectives                                 â”‚  â”‚
â”‚  â”‚  â””â”€ Detailed Text Areas                                   â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Step 4: Review & Generate                                â”‚  â”‚
â”‚  â”‚  â”œâ”€ Configuration Summary                                 â”‚  â”‚
â”‚  â”‚  â””â”€ Generate Button                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PROMPT ENGINEERING LAYER                      â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              System Prompt Builder                        â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â€¢ JSON Schema Definition                                 â”‚  â”‚
â”‚  â”‚  â€¢ Configuration Parameters                               â”‚  â”‚
â”‚  â”‚  â€¢ Critical Guidelines (9 sections)                       â”‚  â”‚
â”‚  â”‚  â€¢ Learning Objective Integration                         â”‚  â”‚
â”‚  â”‚  â€¢ Sequential Unlock Logic                                â”‚  â”‚
â”‚  â”‚  â€¢ Randomization Instructions                             â”‚  â”‚
â”‚  â”‚  â€¢ Assessment Design Rules                                â”‚  â”‚
â”‚  â”‚  â€¢ Feedback Requirements                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              User Message Builder                         â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â€¢ Industry Context                                       â”‚  â”‚
â”‚  â”‚  â€¢ Topic Summary                                          â”‚  â”‚
â”‚  â”‚  â€¢ Location & Date                                        â”‚  â”‚
â”‚  â”‚  â€¢ Learning Objectives List                               â”‚  â”‚
â”‚  â”‚  â€¢ Game Mechanics Config                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       AI SERVICE LAYER                           â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  Gemini API Call                          â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â€¢ API Key Validation                                     â”‚  â”‚
â”‚  â”‚  â€¢ Request Construction                                   â”‚  â”‚
â”‚  â”‚  â€¢ Timeout Handling                                       â”‚  â”‚
â”‚  â”‚  â€¢ Response Streaming                                     â”‚  â”‚
â”‚  â”‚  â€¢ Error Recovery                                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RESPONSE PROCESSING LAYER                     â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              JSON Parser & Validator                      â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  1. Remove markdown code blocks                           â”‚  â”‚
â”‚  â”‚  2. Extract JSON object                                   â”‚  â”‚
â”‚  â”‚  3. Parse JSON                                            â”‚  â”‚
â”‚  â”‚  4. Validate structure                                    â”‚  â”‚
â”‚  â”‚  5. Check required fields                                 â”‚  â”‚
â”‚  â”‚  6. Verify suspect count                                  â”‚  â”‚
â”‚  â”‚  7. Validate evidence documents                           â”‚  â”‚
â”‚  â”‚  8. Check question format                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA TRANSFORMATION LAYER                     â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            Node & Edge Generator                          â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Generated Nodes:                                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ Story Introduction Node                               â”‚  â”‚
â”‚  â”‚  â”œâ”€ Suspect Nodes (with unlock conditions)                â”‚  â”‚
â”‚  â”‚  â”œâ”€ Evidence Nodes (3 per suspect)                        â”‚  â”‚
â”‚  â”‚  â”œâ”€ Question Nodes (per evidence)                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ Logic Nodes (unlock gates)                            â”‚  â”‚
â”‚  â”‚  â””â”€ Identify Culprit Node                                 â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  Generated Edges:                                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ Story â†’ Suspect 1                                     â”‚  â”‚
â”‚  â”‚  â”œâ”€ Suspect â†’ Evidence (3 edges)                          â”‚  â”‚
â”‚  â”‚  â”œâ”€ Evidence â†’ Questions                                  â”‚  â”‚
â”‚  â”‚  â”œâ”€ Questions â†’ Logic Gate                                â”‚  â”‚
â”‚  â”‚  â”œâ”€ Logic Gate â†’ Next Suspect                             â”‚  â”‚
â”‚  â”‚  â””â”€ Final Suspect â†’ Identify                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EDITOR INTEGRATION LAYER                    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              React Flow Integration                       â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â€¢ setNodes(preparedNodes)                                â”‚  â”‚
â”‚  â”‚  â€¢ setEdges(generatedEdges)                               â”‚  â”‚
â”‚  â”‚  â€¢ reactFlowInstance.fitView()                            â”‚  â”‚
â”‚  â”‚  â€¢ Save to Firestore                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User      â”‚
â”‚   Input     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Input Validation                            â”‚
â”‚  â€¢ Industry selected?                                    â”‚
â”‚  â€¢ Topic length > 10 chars?                              â”‚
â”‚  â€¢ Location provided?                                    â”‚
â”‚  â€¢ Date selected?                                        â”‚
â”‚  â€¢ Difficulty chosen?                                    â”‚
â”‚  â€¢ Suspect count valid (2-10)?                           â”‚
â”‚  â€¢ At least 1 learning objective?                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Prompt Construction                            â”‚
â”‚                                                           â”‚
â”‚  System Prompt:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ You are the "Lead Game Architect..."            â”‚   â”‚
â”‚  â”‚ CRITICAL: RETURN ONLY VALID JSON...             â”‚   â”‚
â”‚  â”‚ Generate a comprehensive mystery...              â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚ CONFIGURATION:                                    â”‚   â”‚
â”‚  â”‚ - Industry: ${industry}                          â”‚   â”‚
â”‚  â”‚ - Topic: ${topic}                                â”‚   â”‚
â”‚  â”‚ - Location: ${location}                          â”‚   â”‚
â”‚  â”‚ - Date: ${date}                                  â”‚   â”‚
â”‚  â”‚ - Difficulty: ${difficulty}                      â”‚   â”‚
â”‚  â”‚ - Suspects: ${suspectCount}                      â”‚   â”‚
â”‚  â”‚ - Diversity: ${enableDiversity}                  â”‚   â”‚
â”‚  â”‚ - Objectives: ${learningObjectives}              â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚ CORE DIRECTIVES:                                 â”‚   â”‚
â”‚  â”‚ 1. Narrative Architecture                        â”‚   â”‚
â”‚  â”‚ 2. Instructional Design                          â”‚   â”‚
â”‚  â”‚ 3. Feedback Schema                               â”‚   â”‚
â”‚  â”‚ ...                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                           â”‚
â”‚  User Message:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ CONTEXT:                                         â”‚   â”‚
â”‚  â”‚ Industry: Finance & Banking                      â”‚   â”‚
â”‚  â”‚ Topic: Data breach at GlobalBank...              â”‚   â”‚
â”‚  â”‚ Location: London, UK                             â”‚   â”‚
â”‚  â”‚ Date: 2024-03-15                                 â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚ LEARNING OBJECTIVES:                             â”‚   â”‚
â”‚  â”‚ 1. Identify social engineering tactics...        â”‚   â”‚
â”‚  â”‚ 2. Understand MFA bypass techniques...           â”‚   â”‚
â”‚  â”‚ ...                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Gemini API Call                             â”‚
â”‚                                                           â”‚
â”‚  POST https://generativelanguage.googleapis.com/...     â”‚
â”‚                                                           â”‚
â”‚  Headers:                                                â”‚
â”‚  â€¢ Content-Type: application/json                        â”‚
â”‚  â€¢ x-goog-api-key: ${apiKey}                            â”‚
â”‚                                                           â”‚
â”‚  Body:                                                   â”‚
â”‚  {                                                       â”‚
â”‚    "contents": [{                                        â”‚
â”‚      "parts": [{                                         â”‚
â”‚        "text": "${systemPrompt}\n\n${userMessage}"      â”‚
â”‚      }]                                                  â”‚
â”‚    }]                                                    â”‚
â”‚  }                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI Response                                 â”‚
â”‚                                                           â”‚
â”‚  Raw Response:                                           â”‚
â”‚  ```json                                                 â”‚
â”‚  {                                                       â”‚
â”‚    "caseTitle": "The GlobalBank Breach",                â”‚
â”‚    "caseDescription": "A sophisticated cyber...",        â”‚
â”‚    "mastermindIndex": 2,                                â”‚
â”‚    "suspects": [                                         â”‚
â”‚      {                                                   â”‚
â”‚        "id": "suspect-1",                               â”‚
â”‚        "name": "Sarah Chen",                            â”‚
â”‚        "role": "Senior Security Analyst",               â”‚
â”‚        "identity": {...},                               â”‚
â”‚        "alibi": "...",                                  â”‚
â”‚        "motive": "...",                                 â”‚
â”‚        "personality": "...",                            â”‚
â”‚        "unlockCondition": null,                         â”‚
â”‚        "evidenceDocuments": [                           â”‚
â”‚          {                                              â”‚
â”‚            "id": "evidence-1-1",                        â”‚
â”‚            "label": "Access Log Analysis",              â”‚
â”‚            "description": "...",                        â”‚
â”‚            "imagePrompt": "...",                        â”‚
â”‚            "questions": [                               â”‚
â”‚              {                                          â”‚
â”‚                "id": "q-1-1-1",                         â”‚
â”‚                "question": "Fill in the blank...",      â”‚
â”‚                "correctAnswer": "...",                  â”‚
â”‚                "distractors": [...],                    â”‚
â”‚                "hint": "...",                           â”‚
â”‚                "correctExplanation": "...",             â”‚
â”‚                "distractorExplanations": [...],         â”‚
â”‚                "learningObjective": "..."               â”‚
â”‚              }                                          â”‚
â”‚            ]                                            â”‚
â”‚          }                                              â”‚
â”‚        ]                                                â”‚
â”‚      }                                                   â”‚
â”‚    ],                                                    â”‚
â”‚    "nodes": [...],                                       â”‚
â”‚    "edges": [...]                                        â”‚
â”‚  }                                                       â”‚
â”‚  ```                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Response Processing                            â”‚
â”‚                                                           â”‚
â”‚  Step 1: Clean Response                                  â”‚
â”‚  â€¢ Remove ```json and ``` markers                        â”‚
â”‚  â€¢ Extract JSON object (find { to })                     â”‚
â”‚                                                           â”‚
â”‚  Step 2: Parse JSON                                      â”‚
â”‚  â€¢ JSON.parse(cleanedResponse)                          â”‚
â”‚  â€¢ Catch syntax errors                                   â”‚
â”‚                                                           â”‚
â”‚  Step 3: Validate Structure                              â”‚
â”‚  â€¢ Check data.suspects exists                            â”‚
â”‚  â€¢ Check data.nodes exists                               â”‚
â”‚  â€¢ Check data.edges exists                               â”‚
â”‚  â€¢ Verify suspect count                                  â”‚
â”‚  â€¢ Validate evidence documents (3 per suspect)           â”‚
â”‚  â€¢ Validate questions per document                       â”‚
â”‚                                                           â”‚
â”‚  Step 4: Transform for Editor                            â”‚
â”‚  â€¢ Add onChange handlers to nodes                        â”‚
â”‚  â€¢ Add onDuplicate handlers                              â”‚
â”‚  â€¢ Add learningObjectives context                        â”‚
â”‚  â€¢ Position nodes for layout                             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Editor Integration                          â”‚
â”‚                                                           â”‚
â”‚  onGenerate(data.nodes, data.edges, metadata)           â”‚
â”‚                                                           â”‚
â”‚  Editor.jsx:                                             â”‚
â”‚  â€¢ setNodes(preparedNodes)                               â”‚
â”‚  â€¢ setEdges(generatedEdges)                              â”‚
â”‚  â€¢ setCaseTitle(metadata.caseTitle)                      â”‚
â”‚  â€¢ setCaseDescription(metadata.caseDescription)          â”‚
â”‚  â€¢ reactFlowInstance.fitView({ duration: 800 })         â”‚
â”‚                                                           â”‚
â”‚  Firestore:                                              â”‚
â”‚  â€¢ Save nodes, edges, metadata to cases/${projectId}    â”‚
â”‚  â€¢ Update updatedAt timestamp                            â”‚
â”‚  â€¢ Increment nodeCount                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Mystery   â”‚
â”‚   Ready!    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ® Player Experience Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PLAYER JOURNEY                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Start Game
    â”‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Story Introduction Node                                 â”‚
â”‚  â€¢ Case title and description                            â”‚
â”‚  â€¢ Industry context                                      â”‚
â”‚  â€¢ Location and date                                     â”‚
â”‚  â€¢ Initial mystery setup                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Suspect 1 (UNLOCKED - unlockCondition: null)           â”‚
â”‚  â€¢ Name, role, identity                                  â”‚
â”‚  â€¢ Alibi statement                                       â”‚
â”‚  â€¢ Personality traits                                    â”‚
â”‚  â€¢ Access to 3 evidence documents                        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â†’ Evidence 1-1 â”€â”€â†’ Question 1 â”€â”€â†’ Feedback
       â”‚                  â”œâ†’ Question 2 â”€â”€â†’ Feedback
       â”‚                  â””â†’ Question 3 â”€â”€â†’ Feedback
       â”‚
       â”œâ”€â”€â†’ Evidence 1-2 â”€â”€â†’ Question 1 â”€â”€â†’ Feedback
       â”‚                  â”œâ†’ Question 2 â”€â”€â†’ Feedback
       â”‚                  â””â†’ Question 3 â”€â”€â†’ Feedback
       â”‚
       â””â”€â”€â†’ Evidence 1-3 â”€â”€â†’ Question 1 â”€â”€â†’ Feedback
                          â”œâ†’ Question 2 â”€â”€â†’ Feedback
                          â””â†’ Question 3 â”€â”€â†’ Feedback
                                 â”‚
                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Logic Gate: All Evidence 1 Collected?                  â”‚
â”‚  â€¢ Check: evidence-1-1 âœ“                                â”‚
â”‚  â€¢ Check: evidence-1-2 âœ“                                â”‚
â”‚  â€¢ Check: evidence-1-3 âœ“                                â”‚
â”‚  â†’ TRUE: Unlock Suspect 2                               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Suspect 2 (UNLOCKED - unlockCondition: "evidence-1-3") â”‚
â”‚  â€¢ New suspect revealed                                  â”‚
â”‚  â€¢ Access to 3 new evidence documents                    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â†’ Evidence 2-1 â”€â”€â†’ Questions â”€â”€â†’ Feedback
       â”œâ”€â”€â†’ Evidence 2-2 â”€â”€â†’ Questions â”€â”€â†’ Feedback
       â””â”€â”€â†’ Evidence 2-3 â”€â”€â†’ Questions â”€â”€â†’ Feedback
                                 â”‚
                                 â†“
                          Logic Gate
                                 â”‚
                                 â†“
                          Suspect 3
                                 â”‚
                                 â†“
                          [Continue...]
                                 â”‚
                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Final Suspect (Last in sequence)                       â”‚
â”‚  â€¢ Complete all evidence                                 â”‚
â”‚  â€¢ Answer all questions                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Identify Culprit Node                                   â”‚
â”‚  â€¢ Review all suspects                                   â”‚
â”‚  â€¢ Select the mastermind                                 â”‚
â”‚  â€¢ Submit accusation                                     â”‚
â”‚  â€¢ Reveal: Correct/Incorrect                             â”‚
â”‚  â€¢ Show explanation                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Game Complete                                           â”‚
â”‚  â€¢ Learning objectives achieved                          â”‚
â”‚  â€¢ Score/performance summary                             â”‚
â”‚  â€¢ Certificate/badge (if applicable)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ State Management Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Component State                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Initial State:
{
  step: 1,
  industry: '',
  topic: '',
  location: '',
  date: '',
  difficulty: 'medium',
  suspectCount: 4,
  enableDiversity: true,
  learningObjectives: [{ id: 1, objective: '' }],
  isGenerating: false,
  error: null,
  progress: 0
}

User Actions:
â”œâ”€ setIndustry(id) â”€â”€â†’ Update industry state
â”œâ”€ setTopic(text) â”€â”€â†’ Update topic state
â”œâ”€ setLocation(text) â”€â”€â†’ Update location state
â”œâ”€ setDate(date) â”€â”€â†’ Update date state
â”œâ”€ setDifficulty(level) â”€â”€â†’ Update difficulty state
â”œâ”€ setSuspectCount(count) â”€â”€â†’ Update suspectCount state
â”œâ”€ setEnableDiversity(bool) â”€â”€â†’ Update enableDiversity state
â”œâ”€ addObjective() â”€â”€â†’ Add new objective to array
â”œâ”€ updateObjective(id, value) â”€â”€â†’ Update specific objective
â”œâ”€ removeObjective(id) â”€â”€â†’ Remove objective from array
â”œâ”€ nextStep() â”€â”€â†’ Increment step (with validation)
â”œâ”€ prevStep() â”€â”€â†’ Decrement step
â””â”€ handleGenerate() â”€â”€â†’ Trigger AI generation

Generation Flow:
1. setIsGenerating(true)
2. setError(null)
3. setProgress(0)
4. Start progress interval (0 â†’ 90%)
5. Call AI API
6. Parse response
7. Validate data
8. setProgress(95%)
9. Transform nodes/edges
10. setProgress(100%)
11. onGenerate(nodes, edges, metadata)
12. onClose()
13. resetForm()
14. setIsGenerating(false)

Error Flow:
1. Catch error
2. setError(error.message)
3. setIsGenerating(false)
4. setProgress(0)
5. Display error to user
```

---

## ğŸ¨ UI Component Hierarchy

```
AICaseGeneratorModalAdvanced
â”‚
â”œâ”€ AnimatePresence
â”‚  â””â”€ Modal Container (fixed overlay)
â”‚     â”‚
â”‚     â”œâ”€ Header Section
â”‚     â”‚  â”œâ”€ Brain Icon
â”‚     â”‚  â”œâ”€ Title & Subtitle
â”‚     â”‚  â”œâ”€ Close Button
â”‚     â”‚  â””â”€ Progress Bar
â”‚     â”‚     â”œâ”€ Step Counter
â”‚     â”‚     â””â”€ Animated Bar
â”‚     â”‚
â”‚     â”œâ”€ Content Section (scrollable)
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ Step 1: Industry Context
â”‚     â”‚  â”‚  â”œâ”€ Industry Grid (8 buttons)
â”‚     â”‚  â”‚  â”œâ”€ Topic Textarea
â”‚     â”‚  â”‚  â”œâ”€ Location Input
â”‚     â”‚  â”‚  â””â”€ Date Picker
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ Step 2: Game Mechanics
â”‚     â”‚  â”‚  â”œâ”€ Difficulty Buttons (3)
â”‚     â”‚  â”‚  â”œâ”€ Suspect Count Slider
â”‚     â”‚  â”‚  â””â”€ Diversity Checkbox
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ Step 3: Learning Objectives
â”‚     â”‚  â”‚  â”œâ”€ Objective List (dynamic)
â”‚     â”‚  â”‚  â”‚  â””â”€ Objective Item
â”‚     â”‚  â”‚  â”‚     â”œâ”€ Textarea
â”‚     â”‚  â”‚  â”‚     â””â”€ Remove Button
â”‚     â”‚  â”‚  â””â”€ Add Objective Button
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ Step 4: Review
â”‚     â”‚  â”‚  â”œâ”€ Context Summary Card
â”‚     â”‚  â”‚  â”œâ”€ Mechanics Summary Grid
â”‚     â”‚  â”‚  â””â”€ Info Alert
â”‚     â”‚  â”‚
â”‚     â”‚  â””â”€ Loading State
â”‚     â”‚     â”œâ”€ Spinner Animation
â”‚     â”‚     â”œâ”€ Status Text
â”‚     â”‚     â””â”€ Progress Bar
â”‚     â”‚
â”‚     â””â”€ Footer Section
â”‚        â”œâ”€ Previous Button
â”‚        â”œâ”€ Error Display
â”‚        â””â”€ Next/Generate Button
â”‚
â””â”€ Framer Motion Animations
   â”œâ”€ Modal entrance/exit
   â”œâ”€ Step transitions
   â”œâ”€ Progress bar
   â””â”€ Loading spinner
```

---

## ğŸ“¦ Dependencies & Integrations

```
External Dependencies:
â”œâ”€ react (UI framework)
â”œâ”€ framer-motion (animations)
â”œâ”€ lucide-react (icons)
â”œâ”€ @/lib/ai (AI service integration)
â””â”€ @/lib/config (settings management)

Internal Integrations:
â”œâ”€ Editor.jsx (parent component)
â”œâ”€ CustomNodes.jsx (node types)
â”œâ”€ Firestore (data persistence)
â””â”€ React Flow (graph visualization)

API Integrations:
â””â”€ Google Gemini API
   â”œâ”€ Endpoint: generativelanguage.googleapis.com
   â”œâ”€ Method: POST
   â”œâ”€ Auth: API Key
   â””â”€ Model: gemini-pro
```

---

## ğŸš€ Deployment Architecture

```
Development:
â”œâ”€ Local Dev Server (Vite)
â”œâ”€ Hot Module Replacement
â””â”€ Source Maps

Production Build:
â”œâ”€ Vite Build Process
â”œâ”€ Code Minification
â”œâ”€ Tree Shaking
â”œâ”€ Chunk Splitting
â””â”€ Asset Optimization

Hosting:
â”œâ”€ Static Files â†’ CDN
â”œâ”€ Firestore â†’ Google Cloud
â”œâ”€ AI API â†’ Google Cloud
â””â”€ Authentication â†’ Firebase Auth
```

This architecture ensures scalability, maintainability, and optimal performance for the Advanced AI Mystery Wizard system.
